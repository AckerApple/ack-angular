{"version":3,"sources":["../src/ErrorLog.ts"],"names":[],"mappings":"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","file":"ErrorLog.js","sourceRoot":"","sourcesContent":["import { Injectable } from '@angular/core';\n\n export class ErrorLog{\n  public log = []\n  public maxLog = 30\n\n  monitorWindow(win?){\n    win = win || window\n    const callback = (evt)=>this.add(evt,false)\n    win.addEventListener('error', callback);\n  }\n\n  reject(err){\n    const e = this.add(err)\n    return Promise.reject(e)\n  }\n\n  rejector(){\n    return err => this.reject(err)\n  }\n\n  add(e, toConsole?){\n    const ob = this.paramAudit(e,toConsole)\n    this.log.unshift( ob );\n    if(this.maxLog){\n      while(this.log.length>this.maxLog){\n        this.log.pop()//remove last\n      }\n    }\n    return logObToErrorObject(ob)\n  }\n\n  paramAudit(e, toConsole?){\n    if(e.constructor==String){\n      e = new Error(e)\n    }\n\n    if(toConsole==null || toConsole)console.error(e)\n\n    const err = this.objectifyError(e);\n    err['datetime'] = err['datetime']||getDateTimeString()\n\n    if(!e.message && e.status==-1){\n      e.message = \"Cannot connect to server\"\n      e.details = e.details || \"Connection to internet maybe down. Also possible CORS needs be to enabled at remote server.\"\n    }\n\n    return err\n  }\n\n  objectifyError(err){\n    const keys = Object.getOwnPropertyNames(err)\n    keys.push.apply(keys, Object.keys(err))\n    const recErr = {}//new Error(err.message || err.name || err.type || 'Unexpected Error Occured')\n    keys.forEach(v=>recErr[v]=err[v])\n    if(typeof err.stack!='undefined')recErr['stack'] = err.stack\n    if(typeof err.message!='undefined')recErr['message'] = err.message\n    if(typeof err.name!='undefined')recErr['name'] = err.name\n    if(typeof err.arguments!='undefined')recErr['arguments'] = err.arguments\n    if(typeof err.type!='undefined')recErr['type'] = err.type\n    return recErr\n  }\n\n  /** same as reject but uses native throw instead of native Promise.reject */\n  rethrow(err){\n    const e = this.add(err)\n    throw e\n  }\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\n\nfunction logObToErrorObject(log){\n  const e = new Error( log.message || log.name || 'Unexpected Error Occured' )\n  Object.keys(log).forEach( v=>e[v]=log[v] )\n  return e\n}\n\nfunction getDateTimeString(){\n  return (function(d){return (('0'+(d.getMonth()+1)).slice(-2)+'/'+('0'+d.getDate()).slice(-2)+'/'+d.getFullYear())})(new Date())+' '+(function(d){var h=d.getHours(),t='AM',m=d.getMinutes();var mn = m<10?'0'+m:m;h = h>=12?(t='PM',h-12||12):h==0?12:h;return ('0'+h).slice(-2)+':'+('0'+mn).slice(-2)+' '+t})(new Date())\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}